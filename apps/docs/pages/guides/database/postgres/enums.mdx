import Layout from '~/layouts/DefaultGuideLayout'

export const meta = {
  id: 'enums',
  title: 'Managing Enums in Postgres',
  description: 'Define a stric set of values for application.',
}

Enums in Postgres are a custom data type. They allow you to define a set of values (or labels) that a column can hold. They are useful when you have a fixed set of possible values for a column.

## Creating Enums

You can define a Postgres Enum using the `create type` statement. Here's an example:

{/* prettier-ignore */}
```sql
create type mood as enum (
  'happy',
  'sad',
  'excited',
  'calm'
);
```

In this example, we've created an Enum called "mood" with four possible values.

## Using Enums in tables

To use the Enum in a table, you can define a column with the Enum type. For example:

{/* prettier-ignore */}
```sql
create table person (
  id serial primary key,
  name text,
  current_mood mood
);
```

Here, the `current_mood` column can only have values from the "mood" Enum.

### Inserting Data with Enums

You can insert data into a table with Enum columns by specifying one of the Enum values:

{/* prettier-ignore */}
```sql
insert into person
  (name, current_mood)
values
  ('Alice', 'happy');
```

### Querying Data with Enums

When querying data, you can filter and compare Enum values as usual:

{/* prettier-ignore */}
```sql
select * 
from person 
where current_mood = 'sad';
```

## Managing Enums

You can manage your Enums using the `alter type` statement. Here are some examples:

## Updating Enum Values

You can update the value of an Enum column:

{/* prettier-ignore */}
```sql
update person
set current_mood = 'excited'
where name = 'Alice';
```

### Adding Enum Values

To add new values to an existing Postgres Enum, you can use the `ALTER TYPE` statement. Here's how you can do it:

Let's say you have an existing Enum called `mood`, and you want to add a new value, `content`:

{/* prettier-ignore */}
```sql
alter type mood add value 'content';
```

### Removing Enum Values

You can remove values from an existing Enum using the `ALTER TYPE` statement:

{/* prettier-ignore */}
```sql
alter type mood add value 'content';
```

### Getting a list of Enum Values

Check your existing Enum values by querying the enum_range function:

{/* prettier-ignore */}
```sql
select enum_range(null::mood);
```

## Reordering Enum Values

Once an Enum is in use, it's difficult to make changes the the order of the values. However, you can do it by dropping and recreating the Enum. Here's how you can do it for the `mood` Enum above, reodering the values to be in alphabetical order.

First, you need to create a temporary Enum with the values in the desired alphabetical order. You can do this by creating a new Enum type and specifying the values in the order you want:

{/* prettier-ignore */}
```sql
create type mood_temp as enum (
  'calm',
  'excited', 
  'happy', 
  'sad'
);
```

Next, you'll need to update the table that uses the old Enum type to use the new "mood_temp" Enum type. This involves altering the table structure:

```sql
alter table person
  alter column current_mood
  type mood_temp
  using current_mood::text::mood_temp;
```

After updating the column type, you can drop the old Enum type:

```sql
drop type mood;
```

Finally, you can rename the new Enum type to the old name:

```sql
alter type mood_temp rename to mood;
```

## Resources

- Official Postgres Docs: [Enumerated Types](https://www.postgresql.org/docs/current/datatype-enum.html)

export const Page = ({ children }) => <Layout meta={meta} children={children} />

export default Page
